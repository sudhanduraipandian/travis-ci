language: python
python:
- '2.7'
addons:
  postgresql: '9.3'
services:
    - postgresql
    - elasticsearch
env:
  global:
  - DJANGO_SETTINGS_MODULE=hub.settings.server
  - HUB_DB_URL=postgresql://postgres@localhost/travis_ci_test
  - SECRET_KEY=blahblahblah
  - AASHE_DRUPAL_URI=http://www.aashe.org/services/xmlrpc
  - AASHE_DRUPAL_KEY_DOMAIN=acupcc.aashe.org
  - AASHE_DRUPAL_COOKIE_DOMAIN=.aashe.org
  - SEARCHBOX_SSL_URL=http://127.0.0.1:9200/
  - USE_S3=1
  - SSLIFY_DISABLE=1
  - AWS_STORAGE_BUCKET_NAME=aashe-hub-test
  # AASHE_DRUPAL_URI?
  - secure: sA/AAobEg7ROqJZBZbl9BEf8btE+WsEwtpfWpcENMEggi7MafaStLZcrP0dA25QV1J9PvWTX9gQMIrC5Yd+bsA0GX39C3KH2OmzqDZW1+oNUtt2nTLmiQZAQpnci5fNv8PXePodsdEF/45am7+sK9FCB5sHH9tIs9x6VqZiHAGnMTh0PreCns9AiO6JCY0+0/Ch/iTdK/LGdJsqjdwO7mEIm9tqNAVojzfAVQu0zlwXCVWfQpRBBLgAczEUbDhZM7y8+OZ7X7jwY1O+SsOTuw5UHOGKJ1iD4zFluT0WL+TWZB4e39gmxilpd2aj68wwwKsaIPIV/6DIltFLtOCP4AplBT2LhKL5ews19ZBDk8Mi6HvQHYqxZfCqDDZFj5jgSzCB6iiLBxYjw5/DdsZuJz6D67/q632oIK8Tq0udm9FWWTZ8/1+m/e2si7kNGvsEiwUydog1N6DvYLxxDB7Y/5pU9GrHST9JFVBKIyhR3RZchOgUjFl1BNK9CSOE8rBeN2AOZ6Gs1P/gbFPQTljWRzQvL4hAVG+fJeq7jAeqIurZpikURbd4az9QSmmqLexuWGu/NW0HEQqZtA6KDlZrEZ/fVbxSsbt5xzqWRIIHIrzegzvn9RwWqRGy3VjAccHLF/ghybizLCzFQ3STig3xDK6TmxEuVji77sfmN+j9IF1c=
  # AASHE_DRUPAL_KEY_DOMAN?
  - secure: htIbKzn5C6KuRjtSnA7iRPkmXON6LmPTIdHc0G0H5Kv6GMMDghYRZqexZvzUcZiCv6zj0+ml4ibjl2zA8BjymvKkIMoCbQuy6dDAC4BuU/7nuqO8/AQJWlDXfVpIOsNei1bdRRF0RcKHzOHVEf8kr9xHSF5vP5TW+qaqjBDCs5f58zwbA6ayzUYtBZxyxROZWatbGX1gRmcHBkw9jUrkNdUX57bijRJIWwxfuWBFaeLaDKAT0n9KNUQQh8g+mrR1IpV+hVhs1d2kjgoqx+dmW0wlR8+cu5GXWBK3TSqsvaTCD/B5wrkL1c/nSaQ3eF2kxp40lEoHur0dO11oo8TTQSGk8R0MTE6JXFKKN0kCAxS0uMlT7VGNNqElY1Wr7SQ3iq/zejv3iu9VWgdTcr/j0JNAelJ26bUFLEj6zK4Wtv8Gikf3UHoPWUD1UOPvKLTg/0DVj81kqQJ2UkCkH58pPQ5i1Oapj98su5pX4UkI2gh3UPIkoROs5FBGr5UILlyFPbk09k0u+Ccai0uX9ZWmvx/Szx6leNie2HN7TIpi4gsMFnDjhyZsxLHvZl2tVPpxYfbhg64RXAlvSoyxEVp/pqFo4o0MnfggMlh5kckhSYXkOLKj+QeUd8z1omORyVloRf7rqXUisI/Ql/Q98R56fbdcYZ8Tjo++f+DVW4Jplq8=
  # AASHE_DRUPAL_COOKIE_SESSION?
  - secure: E5NHFsELfdA+S8qsxD9H1utofv3Fhej6p0nqaKIOhaTP50jFwdEx8bqMTgEiF2uCwaGpRdBAqewZ6I9/YS1VS9yNlUpCWzqGyTrcN5xeQdk/lQfGnE2SkXomj10RA1SaTa5euqBZ1dcdb3sTXULhELGuoJvkQUu+sN5LWG59DGljSpZ0fuhGLFJMaeTMdsOT8DrO9WHt4dhY7/Kbeet4kk9hPwidB3mi13nMWANByldkuMk23sgyjzcSuOJE6XS1155mvL97gE1v5JobbA2o2rHEAfBfmUOMrWqtHf437rAGGENBYO58ggXNKu2v2uGq68oqXGGKAvf5NakT8t1HApE0lo+zCZLqjIjlBLeTBxpSSzIPK8+GaKiQZHLd+zwcrBUQ9ylAGSUxZjsWaOhOQbFxQrAmZEkWhRyxXoODqSIIYPNkoijKz3033QeMDQ82qPegYao6QNN9kgUyV5xV6IkujMu9pENiB5q089MfHWWnfiXq3ytb7/bLNi55dLcMRXGQRnH32HauF25e0/1PgMZeLt1hiNcBPkuxntWcUltPh/G49GJ9ZFw9F7rVotYOfjZGLaf0PSXl1QeBpqarZzIlTE9J+JHwPvYiC8yu2LWWAoq6rRUb1h0BlcoHBDA1P4R1z1v52y0WiO9Ad6lnG3V1iG/qUCGichGBXNS/Ja8=
  # COVERALLS_REPO_TOKEN?
  - secure: ylVwaRm3n803js5uQ+j7Ww42V/pBKVy1538twdisUMb7tOehzBu6H8Oy2z+p+jLknirc5PtQrN9OxD1UYYtG4hsyJ+Fxfx6Lii31ADQOktgYxeVEHrCLiBce5X5hZRMx1QpfMwoVEvqjtvPW2KgcxI/58bF+RrZcrBguw6Vn2JcY1AeiJR+Ql7uXWqSd46xbDFuGZihrZfenwlF7ait/ZP0/FTk+OK7Z7lk9eQehci6TJTm0Lip60mK7vOPvBJwlYP9rs50WUbtPa7YYQZ2cNwbX7ge2tlOn/Sz9Wnaz5KEbse1l9wk2tED+4jJi5IheUxsxII43pfOWfiknKNKl1m7BL2uxyXquL8p2nYWDbF9zimUWtcQMMZgWR1v7Okpdyw1Hr76DVXon1ancSyZStbIO0v2G+j6ZwHAWY5jmlQJDocH2pe2qjJevl3Wlg+pmmhmiQ3i3REsTK51b5zlK0at+WZbw+Y+8y6UiJ3lIM3qXlaBDAE0/NotkE8s3r674NB/H4S5CJZ2zkzCVe0sqjF9BxrYok5LmEzJlhmn8VvrUYkAyvWhLMTd//VM/jp+S/PniLwEwo1JFs21UR7flx5aE38q419++TU1qxhFPbnhVhkpr1RddTLWzb3gxSZjwwzQRxABGL57ItSYzlW5qtHUIJGLlKIJI1tKI5Mxp3lo=
  # AWS_ACCESS_KEY_ID?
  - secure: hAoMquySRCsLI6K+I/WTS1RzCzXEeSvlrW+uc9k4G+w/vlXerP3AARuSJRJJ4gz4nWF+8RAYzOVj3tR21yvOkTZkJbLXZtzeLbh1u0+MwPBcGmd0p4gZELyGldhMumjjqn8bHTmo+KkVbYhUHBuMLVD86ZCrenytDxK9Y3HIJl597mu6ftlFsv6omAhxWLwRWdlzT4WUtr/tZiv69s5OyJg8p/+nfcRDeK7hxuXeVDcFPBOuHRXGXV3gsiJbBt16HhRZsbQdnciMJaqW7AU8/+Pxzg94LSCrQDYMCzxy9MSLZopK/mzrutWGKuk7jdof4BqihgDvm6War5g9rtnvW0RuIhCTpPbikDsLqEd9UdRg7rEPxhCQ5R2sjBwaTEnKzdPHIFEXjKXhL3Un1oxACEUGkZj+qgT+ssdM/f/EwpDBgBKHaNooYRkEVNXooyYqYXFHSUGBXr/6skwLufKFPhQlZ07u1I8Ole09K1xS7b97mu0KT6OK3peDxZH6S7Qkf/kzLIOIoqMOSdleunHYzLD7mJXJKYSbKI7OCPmH6WECABY/TrAwSbRz9KmLjoZrMLiJRQ6sYmmXvJ6G4iiu55zC9BlWu+meHUgQgwOzTwLUbZ+8wSYTLzpLWwT6DL3yFj/wTJGinkX5scpoBLSZapnWVCX3p2IOAcI0jvhj810=
  # AWS_SECRET_ACCESS_KEY?
  - secure: Ae3gg/llfjoN7110QeQSyR7k52lIm1tQGuIU9nhx6vHSdfH8b6Z2NpRdhhJgRjmxhS8E2HKcfvAo/wjTdecl2ERlAse4c3cgmMJYTOBLDhdxjZpKlqWTL9GdnXdoF6eQaPThf83qHo4MI2l+9/dFIfmD7tbeAehrm6Ny+OTlHavPP5bPRpR+N00iMxJsHxA+29Ar27Izsvcp1ySda/4S6LSnySs7itpxwDKLDvMBeEyEf51ZXM3d9iIC3QfwbgF3YcQ8k/P2iopw3VtYsgZeDme5gfbxiMjkCsRzeYRXmai+33eR5fILmIryV5DEEJFaKWg0z7pBjwZlZofKl5VkxPfzrpkPM87sHdVepX6pIxdBJJVxgWUo8x9MJ/Aq4Ypv7EcHfDiQ14VfE33zuIvVao7F3GniIcgnaXyk5d+nTmv1KZ1H0YVF/YecaLxASLhPF3P+KF+gnovX42gUlXGeosiDqlO617fb9gb5XaZ/QB2jocVY++rT/HbWjKPl+bfrmwNko5nHF/WaYhKtcVCErXfZbnChazFPhr/MSWrwbTO6WdTY8bjC2E3g8P7NuRjg0uyww2m9lUtaVsrv9X/EYFKc25x3Tpx74Okie6KkqcFw3n66OetCH1N+zRyOWFEPpuPqAv3UBn7XV9igbeslSlgkCLFweW2s+mtIgVGc9XQ=
  # MS_ACCESS_KEY:
  - secure: "yGFo8ZYeFi2xmIND0Q44sOZxz6yfOUp+abCoHFH7SwIpL4VqMk3p/IuSj3CQn4rtHienyrHaYa1xErlLFJ+Va70hQDkXeFi7P1wtJuY7gVzHT+hmc5RqLx3rVl7kinpU535hR2u4WQkUrQ45khMuNm12OkfzpvG9fZXTITXakBhv2lNdZ4LMG5iC7xOqRED+PC/pk8oIPrQq4N6enVE+txHFoWclPPP8OwnvqSPQzNwRQWWgWfSmEGl1jaUj67uLRx4RyuCKRiOAeCHNKJfOUg3CiQETRjGga74Ug5YHqSdFIY+/0tP3sX7NaFqzO46BzfafsU+a+fXnewkv9DijR0CyTOpdAdN2iot1LW0QOHTRouWLr4soXr48sMmcITzGV4yRhbvjEVZJeO7faNK5XFQIxkwkfGhkHnyEiy7nU1yaoWrN0yKGHAiA5Pobksf64eVSMEjft4KFGJJs9kPpD6qsRlPyhVmvW9fDVa4XgWr/KGDjYTz/BKV5s9ZtiiFlDrHLcoyiQ7PKTmnJmhV9PlcTGrclFI+1C/ZL1gkVGJCDB8MWNEyMFarLSFsYSxcTft09mj8FXbzr2Qe08YBzMiwoI3HNXPrw3V3vqLc+Sk2YGxYDfS+h6UI0dYD7B4vQKY5JYENEMJMdshWP/+YKKWK+msZ5nZK7YHkQgmGLjdg="
  # MS_SECRET_KEY:
  - secure: "lKlq8Fd4UzGXfOFK0hrxOhxlm1LAHUXCQoNS4VsFt82q1k6NcnHIlYREYcRdB/scpyXAVUNZvKEdH3UQ5XRg2oeimZnlgpuHl1DApOHhyoI73fK/6N/5c8dmlyC6KC7X8mVUeUXlFlQ5NoWVzvfDDbkTNtmyVl2VmMdBfNuU6LPAMTq9dJSiRxMBfPBEsYwcHg23LZDRx2jf35KJqaoxIUPTcu/1esspgHhO+3MoNrRD2cmv8Xg8sugDjWzjBmns8ltAbuQDsb3i43Ud5nZfjcynHg2vE3rjhIdAdvv15A5TOSFmsUyCs257NoPfjkIvDA5h8C2j8cjZThpZlCHZTZ7YE5qh2wbjZGxM/K4gIfBjZmK2LE4xOpEBXJJ8ANCUcJ3C9r07gKRfK6i7WKOp51PK1q6dZXKe+DovvfB3wiLFsfURCwlpTFCYT8m3okn0sdwPoi0QdhrYM56oWDAmdNIKdaW5HQRveXYDS6rr9IRqh/Kd2VuhfTFR8bmo9E8UnMJgBaAngncSUzuMd01xKUi/6j5iBFngP0/JMof/yDjaktOu70OPwJWSsduim8vXbkYVHYSeSgQOHxBRUn+fNNSo/zTtzCkKqCUt4fD63KUlzydXg9yZM/GlMdIt9uaZedtCgPEL6u96bL9LYVliaPaK1u2XLgm5SGg6tEGY9rw="
  # MS_ASSOCIATION_ID
  - secure: "b0L3opim7e6mUbFnwJruSD4hDDsJ7Dux19Wm1KGhi+1UmNuK4rDoj73UQjbuWrszsp+tQmkKUp3BL2bLegFBWLNN9k/9ywBOdrzlNpcXECyIQ6OLJQUGqH72Zv8QoyXGWqA/sRNJneva46Rof9yVffQDtSx5XI1CicYa9/0M22hVDphpVfGln6UtLhCAl5ROny1u61DaMYvP4YUP5sUxW8HlzvGlfX8itC4RXwhg389OVg5ms1tyU47ijFC63Fzaqt1iGLqxe+Ogl4oEz1j2qlRZVLx55m3XpdxmHAdPWeRHPdFWc3BVf/xLt227XOUCql2nK64lFdqHlI+VzWaCaFpk0+Dqta30kvZ2tkRA6Z/kweLqA6KDWlxzpaJv4nxSmLN+jlFbm2nWOidvgfAzPcDp+HLNH29/2yTyHQrApO2jN4c4Y3j9eoASplvLaWVyte4vDhfbaoKqHNiNTHabyB5nqXW0IPI+A/F3cG4vHui6bmC0TvrjS5qN5LQE+KekFU1C7w2F3avtCA9xwnAnlUeKPtiAJJAeB6JmBxpaPTRHnZMzTSQHc0sF64AWAStD3U28YEJ/YVyeafc0ZXDvo2fqm1D4PamDO/YqjLCYKBSf4NHZtKqi0QN83tUdP4f9/OsFhAVKIxti7KoDgQnm476SxbfvCJncnxovlIYI0dQ="
install:
    - pip install -U pip
    - pip install -U setuptools
    - pip install -r requirements.txt
    - pip install -r requirements_test.txt
before_script:
    - npm install
    - python manage.py collectstatic --noinput --verbosity 0
script: coverage run manage.py test -v3
after_success: coveralls
notifications:
  email: false
