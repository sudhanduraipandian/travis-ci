dist: trusty
jdk:
- openjdk8
language: groovy
env:
  global:
  - # ENCRYPTION_PASSWORD
  - secure: JiBGEaTLbTTBNc1zA4KH1Zkiu7EFW76WSx0IVeeS8XkegpARQHQCY2i1yl3vMmkLZEp1covfF8F9CCic9DX4SCDuoBMLJ1pOsvTzJDvnXAtvwyJSQUtGvePsG/GKhoqTaocTNSqVYWNLs6qFNH9eYgdsofvo5a8TjOmNOw3PGKcrhTv9xYVJSWsU3n/7mtm6AQ9oMnqTsil34y0UvlfTKr6ZbXjt2iY6NFjK0QePk7cZd4+Bd7fWCBkmVcQunZtd6rE9dOMois1QOGlkDr1RfSRqIanjGE9wzGjor534uPQLOp6E+FRwohZcjkiGzUI5eZCx67PBLLSGHdAsk4EUO1RknzjEzvR1zQDwGVLjMiBuKVH9c1P8FCz6KSYTc4p38oKJG2KrD738h7MV6gnQya9AEsv3jnX+6d335VQYNBkefaMmArf79xY2W+1EVvaHmFOMxJ9golswcnFv/fp6dWT9ey+7iXs9JPneKzFvBBDNQwYrGRUyBnwSK2INgxlX2g5h1tQEddJN8i3YUi8s3EXbBlM4bPjdsq4jOnMms1h71/r+pTAaOh0KCPaT+zybmEbkfnAZ3bC0itONKbGf0yzeiYJzWSFgWV2ksJ+qV7X4gZ87dSSy/VGTRxa3obNhuqnhrngChgvT4GTpa6RrLnPcidiheCDoSGKY8UDFOvo=
  - # SONATYPE_USERNAME
  - secure: o0hO1MUjW9l+vPgT019CeSle8We7yxKGL3f9sqw6xKKusw/YHABok7SfbfE1ePzSpXeN+D3lpvmKT6yTb/69RFckzGYF50ygblznsZVVu8q7qL0i2V1vuxYrbHOegKVb1QVSFrWXmbSZe8ZHSF/zmdgGb+4w0HRdri3b3KVmu6a+RO1fY9BiJPnZfa7w35lbQbCFfTLrcyTfSEUZtkviGS5SW9yncPGzZJSAUZHWvEvOCf/3VLstJ2lBHa1EchEEhFGH4vdGUbjbKV9RU0B+G/Rb/o4baQw0S5+wK1+XDfAO2YviG6BMrg9lHW6q8TyMdRZ4ddYPZAj6KB2ISWXXmB0MgUpl9mum2Kae66whj6k0ZkAukOsJgbcnrFdez4lG5kxVLmLJHQHbF+mUjYx+SMbSF8X7PMtzdyfcL13AlS77lX/8aF6kbQbmUKbBr9bxIYupFHmvr5hIypPLEf+Tf7zMGmaZ7NGDIDFUXdDG7Ys+WFuIy0VzpZ4We+s8zAG+BJWrEHRLInEFETYIcV8pvwZHPqnMdrAM7UZT/ahZlYzME/v8S9AZ3dHlyg7f6ybl5AYMCANYs3v1xqu21e6Jgj4UKMz8ek3V8s7BBzOGW6lSSz0bdgNp5XmHuU0Rqpga45OiDXqyjSXNUOiedXRgn2vTOW4Wvw96/+E9EmE0tps=
  - # SONATYPE_PASSWORD
  - secure: hRxPE8K0az6gCm4Pvay8selysjgXg5TMxrgEG5Eg0Z70aex9FrIbG4DmEdP9FJrXnxYDQWsoSMhvkAxMKck/BJKG3Y3RyN8mR+nL7rr4++qfTuBjlqSDVFTK/CR7GDuNR4ez2PopxA7cZ9lyAgo3LjEMSKqlBBhU9JZYJjyFhIcok0DhfUW+XG3UaOP7jLDUj7eKvEUOKvfvuccqHw1k2qr2AjyfeVukoejF70feMB+jP0Vn5yKw6LEjNlofn4TFj47u6ccadey4jgwJlVvD/NeOVSXkxbOYN5HlGOvImoIhlIGFk284pXFtqqG+cbZ9i+a7jsklHOFIqUUOnWqVxzouxtmbu8zH4JxqtKPrtr9suHuiIjOfQHQjR2+w0vD7+NSY3AjAsJ++vvrdr+EnRIonouYalpyDRi9AYtztcXmn4kCpaOJOWBBb9BMhS9uooDw5LsGpdz9q5cWzk1p2nKNkeKyEZ22An+xEBe8A4vqFq764Td+vW6QPwg0zWHfUnO5yHaMu93HwrTBrPFuCXXBl20/6i2316YRroVUrGUcyfSu32UaTVkda9a0dFBVrD4EllsANWlk2hnoYuqbhMIIiV1hC2cK8Vwzd7s/k8SMxRed8OZErXzB/Yqrl1YMH7zznIpR1czEV+9ApZG6tqBBlTTaQZkZiBjgwRTdiI2A=
  - # SIGNING_KEY_ID
  - secure: YkjdfGSIwa7v2yaCjeGSlC7r3pcgMmAwQF3/5YeTly1WuCJHip85LJnWPr5DW5Ch2vd3+UAwZCQ34QpTLMNbaF8xgVdB0tqegUau05vDcAL+HuKrb8Z5pZ/LZsD4NRMFnKJSQeXLBcBy/2/QiJnI3vU0eem4uyL1k416KEmUVYwmqZysJar7MokT+RMh3Z//Gg0CxJ+4USXMxX+vFlaTGpr9wt+Z7jDLl8Rlo2aotgqqqu2DY6U4/fMMJ2ymQHxrseE0MCp9taFpvVo8QBMANPLwDo/cbdpP1FjfSzvI04JcF/4QHCe+vPCdja+qKN8NVTMwV+8gZlu9xbbgkWW6WXCj4Qd3DC4TtmUYDGl0H11ox4xpGZiUxMEQWknYvhSP7PvUQhPNKQzpjPD4W6oZ6q4v/z807NUm05Jth4ur3yXeqZaySHjjI8rtu2A5Ufjd7/tQALeYGbREdKhz7kOiEDQ08KtIVFTuVSFGVLUsNM3y4jQ5OlpK1apQv1gbW1SPFNsjuHVWAgYR7LZqnY2G7lOyW1riPOwoVoZPLNfXhOwoj2a5nT4QVmyVytiN5yv9ZRkOxpeWBvBUT35ypEOmS0TWh8Ed+udYlHbxXb4rF5MfF62QSl5HXP0K96ZFLtmhdqKbmTL4l12a3wxdMQnxnjgRTHgPs68s+resW0UVeIg=
  - # SIGNING_PASSWORD
  - secure: A/ggKvmdESNRHOFaZhb2Gw+UrHyXt1bu+LfXX9EfCMxM3CKff0TVBo5YU5zq3hndBn6RzoGD9D8sE8lyY9GlKn9SpvDtN+yQ1HXJkBDKB0PWKWRM148cYYNzvUQzHYaV18oVWpGllXDiQhpKMrOG14E2VpiXQT+ZiRS1H66aEU78Az7T0ZcSI4W5QqoKUEc3bz1i2XQhBlCRpcZPaNE65IkkoD85hm4oyER/BldXLKLr0WJ3EkViJxsmfQ8PxmN31RijQJscrw5Plx3IQZBxRy91c785dDgrYoAKfVnPEypcO0BoanEcRRFbORJK+BcTK31+0HiIWCta4ou+aAKq8cfPhKcwo6i9suPGcVW4m6Op7qa7ImKxI9d5ErNySxaEGTIL7HkO+ocGlXuROPl8fFFHoYJl9QNobJEEXMNEmAanK6u/JIu0xEfLle8NgIns15OQPEnRr4dtmIgzQcUW4p24anSMTJ/8hXqwGAWO3j7vKk58oVBD8vOZMQ0ECEEVCuBx8bNog53GlxMl0jvM3tHrD1CruFvYPbJ9QaTA4ScSNeD6ZgWjVEdbr7Li3G+33yHl9fHVtwbqH6p/TYPGWS+FVlNPJ3Y+orZRi3uug1UlwjzfKaHqRRMopfrE+5HQuJ3Yq0j7Z4eM9PuaJCjNRIpSDuxxd+0rZ/Ld1CDQaLc=
addons:
  mariadb: 10.0
services:
- docker
script: "./gradlew clean build -x functionalTest"
before_install:
- 'mysql -e "CREATE DATABASE CFBroker;"'
- 'if [ "$TRAVIS_PULL_REQUEST" = "false" ]; then openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in secring.gpg.enc -out local.secring.gpg -d; fi'
- 'docker pull influxdb'
- 'docker run -d --name influx -p 8086:8086 influxdb'
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
  - ".autoconf"
  - "$HOME/.m2"
after_success:
  - ./travis-publish.sh
